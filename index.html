<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>新年快乐</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: "Microsoft YaHei", sans-serif;
            color: #fff;
            cursor: pointer;
            position: relative;
        }
        #text-container {
            position: absolute;
            top: 20%;
            text-align: center;
            opacity: 0;
            transition: opacity 1s ease;
            z-index: 10;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 0 10px #fff, 0 0 20px #ffcc00;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 5;
        }
    </style>
</head>
<body>

<div id="text-container">
    <div id="name-text" style="font-size: 36px; margin-bottom: 20px;"></div>
    <div id="wish-text">新年快乐，万事胜意！</div>
</div>

<script>
    // ==========================
    // 核心功能：无痕随机名字
    // ==========================
    
    // 1. 预设名字列表（已更新：加入了“姐姐”，共11人）
    const nameList = [
        "多静姐姐", 
        "超级美丽的高思涵宝贝", 
        "睿睿老师", 
        "辛雨同志", 
        "段懿轩同志", 
        "榕榕", 
        "亲爱的乔老师", 
        "亲爱的小郄", 
        "孔梦涵", 
        "王晨潇",
        "姐姐"  // <-- 新增的姐姐
    ];

    // 2. 根据链接 # 后面的字符生成一个随机数
    function getHashBasedIndex() {
        const hash = window.location.hash.slice(1); // 获取 # 后面的内容
        if (!hash) return Math.floor(Math.random() * nameList.length); // 如果没有 #，随机一个
        
        // 将字符串转换为数字
        let hashValue = 0;
        for (let i = 0; i < hash.length; i++) {
            hashValue = (hashValue << 5) - hashValue + hash.charCodeAt(i);
            hashValue |= 0; // 转为 32 位整数
        }
        
        // 取绝对值，并对名字列表长度取余数
        return Math.abs(hashValue) % nameList.length;
    }

    // 3. 获取最终显示的名字
    let userName = nameList[getHashBasedIndex()] || "朋友";

    // ==========================
    // 烟花与动画部分
    // ==========================
    
    // 获取 DOM 元素
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    document.body.appendChild(canvas);

    // 设置画布全屏
    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // 烟花粒子类
    class Particle {
        constructor(x, y) {
            this.x = x;
            this.y = y;
            this.vx = (Math.random() - 0.5) * 8; // 水平速度
            this.vy = (Math.random() - 0.5) * 8; // 垂直速度
            this.color = `hsl(${Math.random() * 360}, 100%, 50%)`;
            this.life = 60; // 粒子寿命
            this.decay = Math.random() * 0.5 + 0.5; // 衰减速度
        }

        update() {
            this.x += this.vx;
            this.y += this.vy;
            this.vy += 0.1; // 重力效果
            this.life -= this.decay;
            return this.life > 0;
        }

        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
            ctx.fillStyle = this.color;
            ctx.fill();
        }
    }

    const particles = [];

    function createExplosion(x, y, count = 100) {
        for (let i = 0; i < count; i++) {
            particles.push(new Particle(x, y));
        }
    }

    function animate() {
        ctx.globalCompositeOperation = 'destination-out';
        ctx.fillStyle = 'rgba(0,0,0,0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.globalCompositeOperation = 'lighter';

        for (let i = particles.length - 1; i >= 0; i--) {
            const p = particles[i];
            if (!p.update()) {
                particles.splice(i, 1);
                continue;
            }
            p.draw();
        }

        requestAnimationFrame(animate);
    }

    // ==========================
    // 交互逻辑
    // ==========================

    let hasShown = false;

    function showContent() {
        if (hasShown) return;
        hasShown = true;

        // 1. 显示名字
        document.getElementById('name-text').innerText = userName;
        
        // 2. 文字淡入
        document.getElementById('text-container').style.opacity = 1;

        // 3. 在屏幕中心绽放大量烟花
        createExplosion(canvas.width / 2, canvas.height / 2, 300);
    }

    // 点击屏幕触发
    document.body.addEventListener('click', showContent);

    // 启动动画
    animate();
</script>

</body>
</html>
