<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ–°å¹´å¿«ä¹</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: "Microsoft YaHei", sans-serif;
            color: #fff;
            position: relative;
        }
        #text-container {
            position: absolute;
            top: 20%; /* å¾€ä¸Šæä¸€ç‚¹ï¼Œé˜²æ­¢è¢«çƒŸèŠ±æŒ¡ä½ */
            text-align: center;
            z-index: 10;
        }
        #name-text {
            font-size: 48px; /* åå­—å˜å°ï¼ˆç›¸å¯¹ç¥ç¦è¯­ï¼‰ */
            font-weight: normal;
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(255,255,255,0.8);
            letter-spacing: 5px;
        }
        #wish-text {
            font-size: 80px; /* ç¥ç¦è¯­å·¨å¤§ï¼ˆæ¯”åå­—å¤§å¾ˆå¤šï¼‰ */
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 0 0 20px rgba(255,204,0,0.8);
            line-height: 1.2;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 5;
        }
    </style>
</head>
<body>

<!-- æ–‡å­—å®¹å™¨ -->
<div id="text-container">
    <!-- ç¬¬ä¸€è¡Œï¼šæ˜µç§° (å­—ä½“è¾ƒå°) -->
    <div id="name-text">æ­£åœ¨åŠ è½½...</div>
    <!-- ç¬¬äºŒè¡Œï¼šç¥ç¦è¯­ (å­—ä½“å·¨å¤§ï¼Œå¸¦è¡¨æƒ…åŒ…) -->
    <div id="wish-text">æ–°å¹´å¿«ä¹ï¼Œä¸‡äº‹èƒœæ„ï¼ğŸ‰</div>
</div>

<canvas id="fireworks"></canvas>

<script>
    // ==========================
    // 1. è·å–åå­—é€»è¾‘ (ä¿æŒä¸å˜)
    // ==========================
    const nameList = [
        "å¤šé™å§å§", "è¶…çº§ç¾ä¸½çš„é«˜æ€æ¶µå®è´", "ç¿ç¿è€å¸ˆ", "è¾›é›¨åŒå¿—", 
        "æ®µæ‡¿è½©åŒå¿—", "æ¦•æ¦•", "äº²çˆ±çš„ä¹”è€å¸ˆ", "äº²çˆ±çš„å°éƒ„", 
        "å­”æ¢¦æ¶µ", "ç‹æ™¨æ½‡", "å§å§"
    ];

    function getHashBasedIndex() {
        const hash = window.location.hash.slice(1);
        if (!hash) return Math.floor(Math.random() * nameList.length);
        let hashValue = 0;
        for (let i = 0; i < hash.length; i++) {
            hashValue = (hashValue << 5) - hashValue + hash.charCodeAt(i);
            hashValue |= 0;
        }
        return Math.abs(hashValue) % nameList.length;
    }

    let userName = nameList[getHashBasedIndex()] || "æœ‹å‹";
    document.getElementById('name-text').innerText = userName;

    // ==========================
    // 2. å…¨å±çƒŸèŠ±ç‰¹æ•ˆ (å·²ä¼˜åŒ–ï¼šä¸è§„å¾‹ + å…¨å±)
    // ==========================
    const canvas = document.getElementById('fireworks');
    const ctx = canvas.getContext('2d');

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resize();
    window.addEventListener('resize', resize);

    // ç²’å­æ„é€ å‡½æ•° (å¢åŠ äº†é€Ÿåº¦çš„éšæœºæ€§)
    function Particle(x, y, color) {
        this.x = x;
        this.y = y;
        // é€Ÿåº¦èŒƒå›´åŠ å¤§ï¼Œè®©çˆ†ç‚¸æ›´æ•£ä¹±
        this.vx = (Math.random() - 0.5) * 15; 
        this.vy = (Math.random() - 0.5) * 15;
        this.color = color;
        this.alpha = 1;
        this.decay = Math.random() * 0.03 + 0.01;
    }

    Particle.prototype.update = function() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.15; // å¢åŠ é‡åŠ›ï¼Œä¸‹è½æ„Ÿæ›´å¼º
        this.alpha -= this.decay;
        return this.alpha > 0;
    };

    Particle.prototype.draw = function() {
        ctx.save();
        ctx.globalAlpha = this.alpha;
        ctx.fillStyle = this.color;
        ctx.beginPath();
        // ç²’å­å½¢çŠ¶éšæœºåŒ– (åœ†å½¢/æ–¹å½¢)
        if (Math.random() > 0.5) {
            ctx.arc(this.x, this.y, Math.random() * 3, 0, Math.PI * 2);
        } else {
            ctx.fillRect(this.x, this.y, 2, 2);
        }
        ctx.fill();
        ctx.restore();
    };

    const particles = [];

    // åˆ›å»ºçˆ†ç‚¸ (ä½ç½®æ”¹ä¸ºå…¨å±éšæœºï¼ŒåŒ…æ‹¬è¾¹ç¼˜)
    function explode(x, y) {
        // é¢œè‰²æ”¹ä¸ºéšæœºHSLï¼Œè‰²å½©æ›´ä¸°å¯Œ
        const hue = Math.floor(Math.random() * 360);
        const color = `hsl(${hue}, 100%, 60%)`;
        
        const count = 60 + Math.floor(Math.random() * 40); // ç²’å­æ•°é‡éšæœº
        for(let i = 0; i < count; i++) {
            particles.push(new Particle(x, y, color));
        }
    }

    // åŠ¨ç”»å¾ªç¯
    function animate() {
        // æ‹–å°¾æ•ˆæœï¼šé»‘è‰²åŠé€æ˜å¡«å……ï¼Œåˆ¶é€ æ®‹å½±
        ctx.fillStyle = 'rgba(0,0,0,0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        for(let i = particles.length - 1; i >= 0; i--) {
            if(!particles[i].update()) {
                particles.splice(i, 1);
                continue;
            }
            particles[i].draw();
        }

        requestAnimationFrame(animate);
    }

    // ==========================
    // 3. è‡ªåŠ¨å‘å°„çƒŸèŠ± (æ”¹ä¸ºä¸è§„å¾‹å…¨å±)
    // ==========================
    function launch() {
        // 1. éšæœºä½ç½®ï¼šåŒ…å«å±å¹•å¤–ï¼Œåˆ¶é€ ä»å¤©è€Œé™æˆ–ä»è§’è½é£å…¥çš„æ•ˆæœ
        let x, y;
        const side = Math.floor(Math.random() * 4); // 0=ä¸Š, 1=ä¸‹, 2=å·¦, 3=å³
        switch(side) {
            case 0: // é¡¶éƒ¨
                x = Math.random() * canvas.width;
                y = -20;
                break;
            case 1: // åº•éƒ¨
                x = Math.random() * canvas.width;
                y = canvas.height + 20;
                break;
            case 2: // å·¦è¾¹
                x = -20;
                y = Math.random() * canvas.height;
                break;
            case 3: // å³è¾¹
                x = canvas.width + 20;
                y = Math.random() * canvas.height;
                break;
        }

        // 2. åœ¨éšæœºä½ç½®çˆ†ç‚¸
        explode(x, y);

        // 3. éšæœºå»¶è¿Ÿï¼Œåˆ¶é€ å¯†é›†ä¸”ä¸è§„å¾‹çš„æ„Ÿè§‰
        const delay = 200 + Math.random() * 600;
        setTimeout(launch, delay);
    }

    // å¯åŠ¨
    animate();
    launch();
</script>

</body>
</html>
