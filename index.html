<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ–°å¹´å¿«ä¹</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: "Microsoft YaHei", sans-serif;
            color: #fff;
            position: relative;
        }
        #text-container {
            position: absolute;
            top: 30%; /* è°ƒæ•´ä½ç½®ï¼Œè®©æ•´ä½“æ›´å±…ä¸­ */
            text-align: center;
            z-index: 10;
            /* pointer-events: none; å¦‚æœæƒ³å»æ‰æ–‡å­—é®æŒ¡ç‚¹å‡»æ•ˆæœï¼Œå¯ä»¥è§£å¼€è¿™è¡Œæ³¨é‡Š */
        }
        #name-text {
            font-size: 32px; /* æ˜µç§°ç¨å° */
            font-weight: normal;
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 0 0 5px rgba(255,255,255,0.5);
        }
        #wish-text {
            font-size: 48px; /* ç¥ç¦è¯­å·¨å¤§ */
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 0 0 10px rgba(255,204,0,0.8);
            line-height: 1.4;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 5;
        }
    </style>
</head>
<body>

<!-- æ–‡å­—å®¹å™¨ -->
<div id="text-container">
    <!-- ç¬¬ä¸€è¡Œï¼šæ˜µç§° -->
    <div id="name-text">æ­£åœ¨åŠ è½½...</div>
    <!-- ç¬¬äºŒè¡Œï¼šç¥ç¦è¯­ï¼ˆåŒ…å«å¾®ä¿¡ç¤¼èŠ±è¡¨æƒ…ï¼‰ -->
    <div id="wish-text">æ–°å¹´å¿«ä¹ï¼Œä¸‡äº‹èƒœæ„ï¼ğŸ‰</div>
</div>

<canvas id="fireworks"></canvas>

<script>
    // ==========================
    // 1. è·å–åå­—ï¼ˆä¿æŒä¸å˜ï¼‰
    // ==========================
    const nameList = [
        "å¤šé™å§å§", 
        "è¶…çº§ç¾ä¸½çš„é«˜æ€æ¶µå®è´", 
        "ç¿ç¿è€å¸ˆ", 
        "è¾›é›¨åŒå¿—", 
        "æ®µæ‡¿è½©åŒå¿—", 
        "æ¦•æ¦•", 
        "äº²çˆ±çš„ä¹”è€å¸ˆ", 
        "äº²çˆ±çš„å°éƒ„", 
        "å­”æ¢¦æ¶µ", 
        "ç‹æ™¨æ½‡",
        "å§å§"
    ];

    function getHashBasedIndex() {
        const hash = window.location.hash.slice(1);
        if (!hash) return Math.floor(Math.random() * nameList.length);
        
        let hashValue = 0;
        for (let i = 0; i < hash.length; i++) {
            hashValue = (hashValue << 5) - hashValue + hash.charCodeAt(i);
            hashValue |= 0;
        }
        return Math.abs(hashValue) % nameList.length;
    }

    let userName = nameList[getHashBasedIndex()] || "æœ‹å‹";

    // è®¾ç½®æ˜µç§°
    document.getElementById('name-text').innerText = userName;

    // ==========================
    // 2. å…¨å±çƒŸèŠ±ç‰¹æ•ˆ
    // ==========================
    const canvas = document.getElementById('fireworks');
    const ctx = canvas.getContext('2d');

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resize();
    window.addEventListener('resize', resize);

    // ç²’å­æ„é€ å‡½æ•°
    function Particle(x, y, color) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random() - 0.5) * 10;
        this.vy = (Math.random() - 0.5) * 10;
        this.color = color;
        this.alpha = 1;
        this.decay = Math.random() * 0.05 + 0.02;
    }

    Particle.prototype.update = function() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.1; // é‡åŠ›
        this.alpha -= this.decay;
        return this.alpha > 0;
    };

    Particle.prototype.draw = function() {
        ctx.save();
        ctx.globalAlpha = this.alpha;
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
    };

    const particles = [];

    // åˆ›å»ºçˆ†ç‚¸
    function explode(x, y) {
        // éšæœºé¢œè‰²
        const hue = Math.floor(Math.random() * 360);
        const color = `hsl(${hue}, 100%, 60%)`;
        
        // åˆ›å»ºç²’å­
        const count = 50 + Math.floor(Math.random() * 50);
        for(let i = 0; i < count; i++) {
            particles.push(new Particle(x, y, color));
        }
    }

    // åŠ¨ç”»å¾ªç¯
    function animate() {
        // æ‹–å°¾æ•ˆæœ
        ctx.fillStyle = 'rgba(0,0,0,0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // æ›´æ–°ç²’å­
        for(let i = particles.length - 1; i >= 0; i--) {
            if(!particles[i].update()) {
                particles.splice(i, 1);
                continue;
            }
            particles[i].draw();
        }

        requestAnimationFrame(animate);
    }

    // ==========================
    // 3. è‡ªåŠ¨å‘å°„çƒŸèŠ±
    // ==========================
    function launch() {
        // éšæœºä½ç½®
        const x = Math.random() * canvas.width;
        const y = Math.random() * canvas.height;
        
        explode(x, y);

        // éšæœºå»¶è¿Ÿï¼Œåˆ¶é€ å¯†é›†æ„Ÿ
        const delay = 200 + Math.random() * 400;
        setTimeout(launch, delay);
    }

    // å¯åŠ¨
    animate();
    launch();
</script>

</body>
</html>
