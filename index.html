<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ–°å¹´å¿«ä¹</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: "Microsoft YaHei", sans-serif;
            color: #fff;
            position: relative;
        }
        #text-container {
            position: absolute;
            top: 35%;
            text-align: center;
            z-index: 10;
            width: 90%;
        }
        /* åå­—ï¼šå˜å°ï¼ŒåŠ è‡ªé€‚åº” */
        #name-text {
            font-size: 5vw; /* æ ¹æ®å±å¹•å®½åº¦è‡ªåŠ¨è°ƒæ•´å¤§å° */
            font-weight: normal;
            color: #fff;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(255,255,255,0.8);
            white-space: nowrap; /* å¼ºåˆ¶ä¸æ¢è¡Œ */
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100vw;
        }
        /* ç¥ç¦è¯­ï¼šä¹Ÿå˜å°ï¼ŒåŠ è‡ªé€‚åº” */
        #wish-text {
            font-size: 7vw; /* æ ¹æ®å±å¹•å®½åº¦è‡ªåŠ¨è°ƒæ•´å¤§å° */
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 0 0 20px rgba(255,204,0,0.8);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100vw;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 5;
        }
    </style>
</head>
<body>

<!-- æ–‡å­—å®¹å™¨ -->
<div id="text-container">
    <!-- ç¬¬ä¸€è¡Œï¼šæ˜µç§° (å­—ä½“è¾ƒå°ï¼Œè‡ªé€‚åº”) -->
    <div id="name-text">æ­£åœ¨åŠ è½½...</div>
    <!-- ç¬¬äºŒè¡Œï¼šç¥ç¦è¯­ (å­—ä½“ç¨å¤§ï¼Œè‡ªé€‚åº”ï¼Œå¸¦è¡¨æƒ…åŒ…) -->
    <div id="wish-text">æ–°å¹´å¿«ä¹ï¼Œä¸‡äº‹èƒœæ„ï¼ğŸ‰</div>
</div>

<canvas id="fireworks"></canvas>

<script>
    // ==========================
    // 1. åå­—æ˜ å°„è¡¨ (è‹±æ–‡ç¼©å†™ -> ä¸­æ–‡åå­—)
    // ==========================
    // ä½¿ç”¨å¯¹è±¡æ¥æ˜ å°„ï¼Œæ–¹ä¾¿é€šè¿‡è‹±æ–‡æŸ¥æ‰¾ä¸­æ–‡
    const nameMap = {
        "sun": "äº²çˆ±çš„å­™è€å¸ˆ",
        "gao": "è¶…çº§ç¾ä¸½çš„é«˜æ€æ¶µå®è´",
        "rui": "ç¿ç¿è€å¸ˆ",
        "xin": "è¾›é›¨åŒå¿—",
        "duan": "æ®µæ‡¿è½©",
        "rong": "æ¦•æ¦•",
        "qiao": "äº²çˆ±çš„ä¹”è€å¸ˆ",
        "qie": "äº²çˆ±çš„å°éƒ„",
        "kong": "å­”æ¢¦æ¶µ",
        "wang": "ç‹æ™¨æ½‡",
        "jie": "å§å§"
        // å¦‚æœéœ€è¦åŠ æ–°åå­—ï¼ŒæŒ‰ç…§ "è‹±æ–‡": "ä¸­æ–‡", çš„æ ¼å¼å†™åœ¨è¿™é‡Œ
    };

    // ==========================
    // 2. è·å–é“¾æ¥ä¸­çš„è‹±æ–‡æ ‡è¯†ç¬¦
    // ==========================
    function getNameFromHash() {
        // è·å– # åé¢çš„å†…å®¹ï¼Œå¹¶è½¬ä¸ºå°å†™
        const hash = window.location.hash.slice(1).toLowerCase();
        
        // å¦‚æœæ²¡æœ‰è¾“å…¥ä»»ä½•å†…å®¹ï¼Œé»˜è®¤æ˜¾ç¤ºç¬¬ä¸€ä¸ª
        if (!hash) {
            return "å®";
        }

        // æŸ¥æ‰¾æ˜ å°„è¡¨
        if (nameMap[hash]) {
            return nameMap[hash];
        } else {
            // å¦‚æœè¾“å…¥çš„è‹±æ–‡ä¸åœ¨åˆ—è¡¨é‡Œï¼Œæ˜¾ç¤ºâ€œæœ‹å‹â€
            return "æœ‹å‹";
        }
    }

    let userName = getNameFromHash();
    document.getElementById('name-text').innerText = userName;

    // ==========================
    // 3. å…¨å±çƒŸèŠ±ç‰¹æ•ˆ (å·²åŠ æµ“ç‰ˆ)
    // ==========================
    const canvas = document.getElementById('fireworks');
    const ctx = canvas.getContext('2d');

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resize();
    window.addEventListener('resize', resize);

    // ç²’å­æ„é€ å‡½æ•°
    function Particle(x, y, color) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random() - 0.5) * 15; 
        this.vy = (Math.random() - 0.5) * 15;
        this.color = color;
        this.alpha = 1;
        this.decay = Math.random() * 0.03 + 0.01;
    }

    Particle.prototype.update = function() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.15;
        this.alpha -= this.decay;
        return this.alpha > 0;
    };

    Particle.prototype.draw = function() {
        ctx.save();
        ctx.globalAlpha = this.alpha;
        ctx.fillStyle = this.color;
        ctx.beginPath();
        if (Math.random() > 0.5) {
            ctx.arc(this.x, this.y, Math.random() * 4 + 1, 0, Math.PI * 2);
        } else {
            ctx.fillRect(this.x, this.y, 3, 3);
        }
        ctx.fill();
        ctx.restore();
    };

    const particles = [];

    function explode(x, y) {
        const hue = Math.floor(Math.random() * 360);
        const color = `hsl(${hue}, 100%, 60%)`;
        const count = 100 + Math.floor(Math.random() * 100);
        for(let i = 0; i < count; i++) {
            particles.push(new Particle(x, y, color));
        }
    }

    function animate() {
        ctx.fillStyle = 'rgba(0,0,0,0.03)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        for(let i = particles.length - 1; i >= 0; i--) {
            if(!particles[i].update()) {
                particles.splice(i, 1);
                continue;
            }
            particles[i].draw();
        }

        requestAnimationFrame(animate);
    }

    function launch() {
        let x, y;
        const side = Math.floor(Math.random() * 4);
        switch(side) {
            case 0: // é¡¶éƒ¨
                x = Math.random() * canvas.width;
                y = -20;
                break;
            case 1: // åº•éƒ¨
                x = Math.random() * canvas.width;
                y = canvas.height + 20;
                break;
            case 2: // å·¦è¾¹
                x = -20;
                y = Math.random() * canvas.height;
                break;
            case 3: // å³è¾¹
                x = canvas.width + 20;
                y = Math.random() * canvas.height;
                break;
        }

        explode(x, y);

        const delay = 150 + Math.random() * 300;
        setTimeout(launch, delay);
    }

    // å¯åŠ¨
    animate();
    launch();
</script>

</body>
</html>
